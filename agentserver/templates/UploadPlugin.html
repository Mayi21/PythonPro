<!DOCTYPE html>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8">
<html>
<head>
  <title>插件下发</title>

  <style>

  /* 整体布局样式 */
  body {
    display: flex;
    margin: 0;
  }

  /* 菜单栏样式 */
  .menu-container {
    width: 200px;
    background: #333;
    height: 100vh; /* 100%视窗高度 */
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
  }

  .menu-item {
    padding: 10px 20px;
    color: #fff;
    text-decoration: none;
    font-size: 16px;
  }

  .menu-item:hover {
    background: #555;
    border-radius: 5px;
  }

  .menu-item.active {
    background: #4CAF50;
    border-radius: 5px;
  }

  /* 主体内容样式 */
  .main {
    flex: 1;
    padding: 20px;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
  }

  /* 文件上传样式 */
  .file-input {
    margin-bottom: 10px;
  }

  .ip-input {
    margin-bottom: 10px;
  }

  .upload-btn {
    padding: 10px 20px;
    background: #4CAF50;
    color: #fff;
    border: none;
    border-radius: 4px;
    cursor: pointer;
  }

  .upload-btn:disabled {
    background: #ccc;
    cursor: not-allowed;
  }

  </style>

</head>

<body>

<div class="menu-container">
    <a href="index.html" class="menu-item">首页</a>
    <a href="search.html" class="menu-item">搜索</a>
    <a href="/upload-plugin/" class="menu-item">插件下发</a>
    <a href="display.html" class="menu-item">监控</a>
    <a href="/host-manage/" class="menu-item">实例管理</a>
</div>

<div class="main">

  <div class="container">

    <input type="file" id="fileInput" class="file-input">

    <input type="text" id="ip" class="ip-input" placeholder="输入目标服务器IP和端口">

    <button id="uploadBtn" class="upload-btn">
      上传文件
    </button>

  </div>

</div>

<!-- 上传文件逻辑 -->
<script>
    document.getElementById('uploadBtn').addEventListener('click', uploadFile);
        function uploadFile() {
            const ip = document.getElementById('ip').value;
            console.info(ip);
            const url = 'http://' + ip + '/uploadfiles'; // 替换为实际的 API 接口地址

            const fileInput = document.getElementById('fileInput');
            const file = fileInput.files[0];

            if (!file) {
                alert('请选择文件！');
                return;
            }

            const formData = new FormData();
            formData.append('file', file);

            fetch(url, {
                method: 'POST',
                body: formData
            })
            .then(response => {
                console.log(response)
                if (response.ok) {
                    alert('上传成功！');
                    document.getElementById('ip').value = '';
                    fileInput.value = null;
                } else {
                    alert('上传失败！');
                }
            })
            .catch(error => {
                console.error('Error:', error);
                alert('上传失败！');
            });
        }

        // 检查输入的 IP 地址是否合法
        function validateIP() {
            const ipInput = document.getElementById('ip');
            const ip = ipInput.value;
            const ipPattern = /^(\d{1,3}\.){3}\d{1,3}$/;
            const isValidIP = ipPattern.test(ip);

            const fileInput = document.getElementById('fileInput');
            const uploadButton = document.getElementById('uploadBtn');
            uploadButton.disabled = !isValidIP || !fileInput.files[0];
        }

<!--// 验证逻辑-->
<!--document.getElementById('ip').addEventListener('input', validateIP);-->
<!--document.getElementById('fileInput').addEventListener('change', validateIP);-->
</script>
</body>
</html>
